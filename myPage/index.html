<!DOCTYPE html>
<html lang="en">

<head>

    <head>
        <meta charset="UTF-8">
        <link rel="shortcut icon" href="../imgs/logo.png" type="image/x-icon">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>creddit - myPage</title>

        <!-- BOOTSTRAP CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
            integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

        <!-- BOOTSTRAP jQuery and JS bundle w/ Popper.js -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
            crossorigin="anonymous"></script>

        <!-- Google fonts -->
        <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Roboto:wght@300;400&family=Courgette&display=swap"
            rel="stylesheet">

        <!-- font swesome -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

        <!-- jquery -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

        <!-- custom css -->
        <link rel="stylesheet" href="./../style.css">
        <link rel="stylesheet" href="style.css">

    </head>
</head>

<body class="bg-warning">

    <!-- navigation bar -->
    <section class="m-0">
        <nav class="navbar navbar-expand-lg navbar-dark flex-column">
            <a class="navbar-brand m-0" href="../">
                <img src="../imgs/logo.png" height="28px" alt="">
                creddit
            </a>

            <div>
                <ul class="navbar-nav flex-row">
                    <li class="nav-item mr-5 active">
                        <a class="nav-link" href="">My page</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pr-0" data-action="logout" href="">Log out</a>
                    </li>
            </div>
        </nav>
    </section>


    <!-- content template -->
    <section id="template">
        <h1 class="section-title bg-dark py-2 text-light text-center font-weight-normal"></h1>
        <div class="row m-auto">
            <div class="col-sm-6 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title font-weight-bold my-0">City</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">
                            <span class="font-weight-bold"></span><span class="font-weight-bold">Name :&nbsp;</span>
                            <span class="spanName">Name</span>
                        </p>
                        <p class="card-text mb-4">
                            <span class="font-weight-bold">Description :&nbsp;</span>
                            <span class="spanDes">description</span>
                        </p>
                        <p class="card-text">
                            <span class="text-success font-weight-bold">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-telephone-fill"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M2.267.98a1.636 1.636 0 0 1 2.448.152l1.681 2.162c.309.396.418.913.296 1.4l-.513 2.053a.636.636 0 0 0 .167.604L8.65 9.654a.636.636 0 0 0 .604.167l2.052-.513a1.636 1.636 0 0 1 1.401.296l2.162 1.681c.777.604.849 1.753.153 2.448l-.97.97c-.693.693-1.73.998-2.697.658a17.47 17.47 0 0 1-6.571-4.144A17.47 17.47 0 0 1 .639 4.646c-.34-.967-.035-2.004.658-2.698l.97-.969z" />
                                </svg>
                                Phone Number :&nbsp;
                            </span>
                            <span class="spanPhone">Number</span>
                        </p>
                        <p class="card-text">
                            <span class="text-success font-weight-bold">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope-fill"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z" />
                                </svg>
                                Email :&nbsp;
                            </span>
                            <span class="spanMail">mail</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        var user = JSON.parse(sessionStorage.getItem("myDetails"));
        var userType = user.appliedFor;

        $(window).on('load', () => {
            $('[data-action]').click(function (event) {
                event.preventDefault();
                sessionStorage.clear();
                localStorage.removeItem("myDetails");
                location.replace('../');
            })

            if (user === null) {
                location.replace('../');
            }
            else {
                render();
            }
        });


        function render() {
            let container = $('#template .row');
            let users = JSON.parse(localStorage.getItem("users"));
            let check = (userType === "borrower") ? "lender" : "borrower";
            let found = false;
            $('.section-title').text(check);
            $('.card-text:first-child span:first-child').text(check);

            for (const [key, value] of Object.entries(users)) {
                if (value.appliedFor === check) {
                    found = true;
                    let cloned = container.children(':first-child').clone();
                    cloned.find(".card-title").text(value.city);
                    cloned.find('.spanName').text(value.name);
                    if (value.intRate) {
                        cloned.find('.spanDes').text(value.intRate);
                    }
                    else {
                        cloned.find('.spanDes').remove();
                    }
                    cloned.find('.spanPhone').text(value.phone);
                    cloned.find('.spanMail').text(value.email);
                    container.append(cloned);
                }
            }

            if (!found) {
                alert("No " + check + "s found!\nPlease try again later");
                location.replace("../")
            }
            else {
                container.children(':first-child').remove();
            }
        }
    </script>

</body>

</html>